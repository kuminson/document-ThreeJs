<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>效果 | Three.js 简易教程</title>
    <meta name="description" content="基础概念、简单动画、简易交互">
    
    
    <link rel="preload" href="/document-ThreeJs/assets/css/0.styles.42aeefa9.css" as="style"><link rel="preload" href="/document-ThreeJs/assets/js/app.a4ba395c.js" as="script"><link rel="preload" href="/document-ThreeJs/assets/js/6.38b6a451.js" as="script"><link rel="prefetch" href="/document-ThreeJs/assets/js/10.f0ce24eb.js"><link rel="prefetch" href="/document-ThreeJs/assets/js/11.ea2ef087.js"><link rel="prefetch" href="/document-ThreeJs/assets/js/12.d2d53faa.js"><link rel="prefetch" href="/document-ThreeJs/assets/js/2.9c905d8a.js"><link rel="prefetch" href="/document-ThreeJs/assets/js/3.495df23b.js"><link rel="prefetch" href="/document-ThreeJs/assets/js/4.25219aee.js"><link rel="prefetch" href="/document-ThreeJs/assets/js/5.f1cc4dc3.js"><link rel="prefetch" href="/document-ThreeJs/assets/js/7.5cac5968.js"><link rel="prefetch" href="/document-ThreeJs/assets/js/8.e26501ac.js"><link rel="prefetch" href="/document-ThreeJs/assets/js/9.a8a6718f.js">
    <link rel="stylesheet" href="/document-ThreeJs/assets/css/0.styles.42aeefa9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/document-ThreeJs/" class="home-link router-link-active"><!----> <span class="site-name">Three.js 简易教程</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/document-ThreeJs/basic/" class="nav-link">基础</a></div><div class="nav-item"><a href="/document-ThreeJs/advanced/" class="nav-link router-link-active">进阶</a></div><div class="nav-item"><a href="/document-ThreeJs/SAOoperation/" class="nav-link">骚操作</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/document-ThreeJs/basic/" class="nav-link">基础</a></div><div class="nav-item"><a href="/document-ThreeJs/advanced/" class="nav-link router-link-active">进阶</a></div><div class="nav-item"><a href="/document-ThreeJs/SAOoperation/" class="nav-link">骚操作</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/document-ThreeJs/advanced/" aria-current="page" class="sidebar-link">疑问</a></li><li><a href="/document-ThreeJs/advanced/effect.html" aria-current="page" class="active sidebar-link">效果</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/document-ThreeJs/advanced/effect.html#一、迷雾效果" class="sidebar-link">一、迷雾效果</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/document-ThreeJs/advanced/effect.html#_1-代码" class="sidebar-link">1.代码</a></li><li class="sidebar-sub-header"><a href="/document-ThreeJs/advanced/effect.html#_2-效果" class="sidebar-link">2.效果</a></li><li class="sidebar-sub-header"><a href="/document-ThreeJs/advanced/effect.html#_3-解释" class="sidebar-link">3.解释</a></li><li class="sidebar-sub-header"><a href="/document-ThreeJs/advanced/effect.html#_4-与camera-摄像机-配合提升性能" class="sidebar-link">4.与camera(摄像机)配合提升性能</a></li></ul></li><li class="sidebar-sub-header"><a href="/document-ThreeJs/advanced/effect.html#二、导入模型" class="sidebar-link">二、导入模型</a></li><li class="sidebar-sub-header"><a href="/document-ThreeJs/advanced/effect.html#三、动画" class="sidebar-link">三、动画</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/document-ThreeJs/advanced/effect.html#_1-动画实现方式" class="sidebar-link">1.动画实现方式</a></li><li class="sidebar-sub-header"><a href="/document-ThreeJs/advanced/effect.html#_2-组-group-的应用" class="sidebar-link">2.组(group)的应用</a></li><li class="sidebar-sub-header"><a href="/document-ThreeJs/advanced/effect.html#_3-tween的使用" class="sidebar-link">3.TWEEN的使用</a></li></ul></li><li class="sidebar-sub-header"><a href="/document-ThreeJs/advanced/effect.html#四、交互操作" class="sidebar-link">四、交互操作</a></li><li class="sidebar-sub-header"><a href="/document-ThreeJs/advanced/effect.html#五、粒子" class="sidebar-link">五、粒子</a></li><li class="sidebar-sub-header"><a href="/document-ThreeJs/advanced/effect.html#六、阴影" class="sidebar-link">六、阴影</a></li><li class="sidebar-sub-header"><a href="/document-ThreeJs/advanced/effect.html#七、插件" class="sidebar-link">七、插件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/document-ThreeJs/advanced/effect.html#_1-orbitcontrols" class="sidebar-link">1.orbitControls</a></li><li class="sidebar-sub-header"><a href="/document-ThreeJs/advanced/effect.html#_2-stats-js" class="sidebar-link">2.stats.js</a></li><li class="sidebar-sub-header"><a href="/document-ThreeJs/advanced/effect.html#_3-dat-gui" class="sidebar-link">3.dat.GUI</a></li></ul></li></ul></li><li><a href="/document-ThreeJs/advanced/keng.html" class="sidebar-link">踩坑</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="效果"><a href="#效果" class="header-anchor">#</a> 效果</h1> <h2 id="一、迷雾效果"><a href="#一、迷雾效果" class="header-anchor">#</a> 一、迷雾效果</h2> <p>scene(场景)可以增加迷雾效果，所有远处mesh(网格模型)都会逐渐改变成迷雾的颜色，与camera(摄像机)的far配合，可以达到减少渲染量提升性能的效果。</p> <h3 id="_1-代码"><a href="#_1-代码" class="header-anchor">#</a> 1.代码</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>scene<span class="token punctuation">.</span>fog <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Fog</span><span class="token punctuation">(</span><span class="token number">0x000000</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_2-效果"><a href="#_2-效果" class="header-anchor">#</a> 2.效果</h3> <iframe height="353" scrolling="no" title="迷雾" src="//codepen.io/kuminson/embed/BOPNQb/?height=353&theme-id=0&default-tab=result&embed-version=2" frameborder="no" allowtransparency="true" allowfullscreen="allowfullscreen" style="width: 100%;">See the Pen <a href="https://codepen.io/kuminson/pen/BOPNQb/">迷雾</a> by kuminson (<a href="https://codepen.io/kuminson">@kuminson</a>) on <a href="https://codepen.io">CodePen</a>.
</iframe> <h3 id="_3-解释"><a href="#_3-解释" class="header-anchor">#</a> 3.解释</h3> <p>THREE.Fog( hex, near, far )</p> <table><thead><tr><th>参数</th> <th>描述</th></tr></thead> <tbody><tr><td>hex</td> <td>迷雾的颜色，一般想要达到远处消失的效果，把颜色设置成背景色就行了</td></tr> <tr><td>near</td> <td>从摄像头到多远开始出现迷雾效果</td></tr> <tr><td>far</td> <td>从摄像头到多远迷雾达到最大，也就是完全是迷雾的颜色</td></tr></tbody></table> <p>迷雾效果是场景内都生效的，如果想让某些材质不受影响，可以在材质选项里关闭这个效果</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Material</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">fog</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_4-与camera-摄像机-配合提升性能"><a href="#_4-与camera-摄像机-配合提升性能" class="header-anchor">#</a> 4.与camera(摄像机)配合提升性能</h3> <p>camera(摄像机)主要用到的是透视相机对象PerspectiveCamera，把相机的far参数设定和迷雾far多一点的值，可以实现部分性能优化。</p> <p>THREE.PerspectiveCamera(fov, aspect, near, far)</p> <table><thead><tr><th>参数</th> <th>描述</th></tr></thead> <tbody><tr><td>fov</td> <td>横向视角，摄像机能看到的视野，人类横向视角能到180左右，对于3D视图来说，一般设置60-90度就行。<br>推荐：60</td></tr> <tr><td>aspect</td> <td>渲染出的宽高比，这里就用承载canvas的dom宽高就行。<br>推荐：dom.clientWidth / dom.clientHeight</td></tr> <tr><td>near</td> <td>指定距离摄像机多近的距离开始渲染。<br>推荐：0.1</td></tr> <tr><td>far</td> <td>超出摄像机多远的距离不在渲染，这要根据场景里东西设置的大小来定。 <br>推荐：700</td></tr></tbody></table> <p><img src="/document-ThreeJs/assets/img/perspective_camera.8c6f7d55.png" alt="camera"></p> <h2 id="二、导入模型"><a href="#二、导入模型" class="header-anchor">#</a> 二、导入模型</h2> <p>如果几何体过于复杂，可以利用3DMax、sketchup之类的建模软件进行建模，然后导出模型文件利用对应的加载器加载进来。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://unpkg.com/three<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://threejs.org/examples/js/loaders/OBJLoader.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 创建模型加载器</span>
<span class="token keyword">var</span> loader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>OBJLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
loader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">'https://res.cloudinary.com/kuminson/raw/upload/v1537409648/three.js/chahu_xlo7pg.obj'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">loadedMesh</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 创建材质</span>
      <span class="token keyword">let</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshBasicMaterial</span><span class="token punctuation">(</span> <span class="token punctuation">{</span><span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token number">0x00ff00</span><span class="token punctuation">}</span> <span class="token punctuation">)</span>
      <span class="token comment">// 取出几何体</span>
      <span class="token keyword">let</span> geometry <span class="token operator">=</span> loadedMesh<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>geometry
      <span class="token comment">// 生成mesh</span>
      <span class="token keyword">let</span> chahu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span> geometry<span class="token punctuation">,</span> material <span class="token punctuation">)</span>
     <span class="token comment">// 加入场景中</span>
     scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>chahu<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><iframe height="287" scrolling="no" title="导入模型" src="//codepen.io/kuminson/embed/qMJOWV/?height=287&theme-id=0&default-tab=result&embed-version=2" frameborder="no" allowtransparency="true" allowfullscreen="allowfullscreen" style="width: 100%;">See the Pen <a href="https://codepen.io/kuminson/pen/qMJOWV/">导入模型</a> by kuminson (<a href="https://codepen.io/kuminson">@kuminson</a>) on <a href="https://codepen.io">CodePen</a>.
</iframe> <h2 id="三、动画"><a href="#三、动画" class="header-anchor">#</a> 三、动画</h2> <h3 id="_1-动画实现方式"><a href="#_1-动画实现方式" class="header-anchor">#</a> 1.动画实现方式</h3> <p>动画的实现原理是改动一点mesh(网格模型)参数,比如位置或者旋转角度，然后渲染一帧图片。</p> <p>重复上面的操作，就形成了动画。</p> <p>虽然可以使用setTimeOut()来实现，但是有诸多问题，比如一秒渲染的帧数过多，超过显示器刷新速度，会造成丢帧。</p> <p>这时候可以使用h5的方法requestAnimationFrame()，这个方法可以根据显示器自动设置帧数(基本上是60帧每秒)，使用方法和setTimeOut()类似。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> renderStateId
<span class="token comment">// 逐帧渲染动画</span>
<span class="token function">animate</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// box绕y轴旋转</span>
  box<span class="token punctuation">.</span>rotation<span class="token punctuation">.</span>y <span class="token operator">+=</span> <span class="token number">0.01</span>
  <span class="token comment">// 渲染一帧</span>
  renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>scene<span class="token punctuation">,</span> camera<span class="token punctuation">)</span>
  <span class="token comment">// 递归调用 重复渲染动画</span>
  renderStateId <span class="token operator">=</span> <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>animate<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>requestAnimationFrame调用时会返回一个id值，可以用cancelAnimationFrame()方法取消</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">cancelAnimationFrame</span><span class="token punctuation">(</span>renderStateId<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_2-组-group-的应用"><a href="#_2-组-group-的应用" class="header-anchor">#</a> 2.组(group)的应用</h3> <p>有些动画需要的多个一起运动效果，单独做会很麻烦，但是如果能一起运动就会很简单。这时候就需要组(group)这个对象了。</p> <p>把多个mesh(网格模型)放到一个组(group)里，对组进行动画。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 创建球体</span>
<span class="token keyword">let</span> sphereGeometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SphereBufferGeometry</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span>
<span class="token comment">// 生成球体</span>
<span class="token keyword">let</span> sphere <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>sphereGeometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span>
<span class="token comment">// 复制球体</span>
<span class="token keyword">let</span> sphere2 <span class="token operator">=</span> sphere<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 实例化组</span>
<span class="token keyword">let</span> group <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Group</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 修改球位置</span>
sphere<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">3</span>
sphere2<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">3</span>
<span class="token comment">// 把球加入组中</span>
group<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>sphere<span class="token punctuation">)</span>
group<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>sphere2<span class="token punctuation">)</span>
<span class="token comment">// 把组加入场景中</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>group<span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">anima</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// box绕y轴旋转</span>
  group<span class="token punctuation">.</span>rotation<span class="token punctuation">.</span>y <span class="token operator">+=</span> <span class="token number">0.1</span>
  <span class="token comment">// 渲染一帧</span>
  renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>scene<span class="token punctuation">,</span> camera<span class="token punctuation">)</span>
  <span class="token comment">// 渲染</span>
  <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>anima<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">anima</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><iframe height="349" scrolling="no" title="组" src="//codepen.io/kuminson/embed/PdxgEP/?height=349&theme-id=0&default-tab=result&embed-version=2" frameborder="no" allowtransparency="true" allowfullscreen="allowfullscreen" style="width: 100%;">See the Pen <a href="https://codepen.io/kuminson/pen/PdxgEP/">组</a> by kuminson (<a href="https://codepen.io/kuminson">@kuminson</a>) on <a href="https://codepen.io">CodePen</a>.
</iframe> <h3 id="_3-tween的使用"><a href="#_3-tween的使用" class="header-anchor">#</a> 3.TWEEN的使用</h3> <p>很多时候，模型的运动速率并不是不变的，都是曲线。如果自己写算法会比较麻烦，TWEEN.js就很好的解决此类问题，并且非常适合与requestAnimationFrame()配合使用。</p> <div class="warning custom-block"><p class="custom-block-title">注意</p> <p>要在动画循环里加入TWEEN.update()，来获得每帧变化</p></div> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br></div><pre class="language-js"><code><span class="token comment">// 实例化TWEEN 并设置要改变的对象</span>
<span class="token keyword">new</span> <span class="token class-name">TWEEN<span class="token punctuation">.</span>Tween</span><span class="token punctuation">(</span>sphere<span class="token punctuation">.</span>position<span class="token punctuation">)</span>
      <span class="token comment">// 对象的属性要变成多少值和时间</span>
      <span class="token punctuation">.</span><span class="token function">to</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
      <span class="token comment">// 使用的变化曲线，这里用的是弹性曲线</span>
      <span class="token punctuation">.</span><span class="token function">easing</span><span class="token punctuation">(</span><span class="token constant">TWEEN</span><span class="token punctuation">.</span>Easing<span class="token punctuation">.</span>Bounce<span class="token punctuation">.</span>Out<span class="token punctuation">)</span>
      <span class="token comment">// 无限循环</span>
      <span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">Infinity</span><span class="token punctuation">)</span>
      <span class="token comment">// 开始计算</span>
      <span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">anima</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 计算一帧的变化</span>
  <span class="token constant">TWEEN</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// 渲染一帧</span>
  renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>scene<span class="token punctuation">,</span> camera<span class="token punctuation">)</span>
  <span class="token comment">// 渲染</span>
  <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>anima<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">anima</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><iframe height="358" scrolling="no" title="tween.js使用" src="//codepen.io/kuminson/embed/yxQrrK/?height=358&theme-id=0&default-tab=result&embed-version=2" frameborder="no" allowtransparency="true" allowfullscreen="allowfullscreen" style="width: 100%;">See the Pen <a href="https://codepen.io/kuminson/pen/yxQrrK/">tween.js使用</a> by kuminson (<a href="https://codepen.io/kuminson">@kuminson</a>) on <a href="https://codepen.io">CodePen</a>.
</iframe> <h2 id="四、交互操作"><a href="#四、交互操作" class="header-anchor">#</a> 四、交互操作</h2> <p>有时候会需要鼠标与canvas里的模型进行交互，THREE.js里是这样实现的。</p> <p>简单来说就是计算出鼠标在canvas上的位置，然后发射出一条经过摄像机和鼠标位置的射线，射线穿过的模型会被记录返回。接下来对相应的模型进行操作就可以了</p> <p>先看下代码</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 绑定鼠标松开事件</span>
dom<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'mouseup'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 禁止冒泡</span>
  event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// 计算鼠标位置</span>
  <span class="token keyword">let</span> vector <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>clientX <span class="token operator">/</span> dom<span class="token punctuation">.</span>clientWidth<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>clientY <span class="token operator">/</span> dom<span class="token punctuation">.</span>clientHeight<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span>
  <span class="token comment">// 把屏幕上的二维矩阵换算成场景里的三维矩阵</span>
  vector <span class="token operator">=</span> vector<span class="token punctuation">.</span><span class="token function">unproject</span><span class="token punctuation">(</span>camera<span class="token punctuation">)</span>
  <span class="token comment">// 发出射线</span>
  <span class="token keyword">let</span> raycaster <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Raycaster</span><span class="token punctuation">(</span>camera<span class="token punctuation">.</span>position<span class="token punctuation">,</span> vector<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>camera<span class="token punctuation">.</span>position<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">normalize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token comment">// 设置射线中匹配的mesh</span>
  <span class="token keyword">let</span> intersects <span class="token operator">=</span> raycaster<span class="token punctuation">.</span><span class="token function">intersectObjects</span><span class="token punctuation">(</span><span class="token punctuation">[</span>box<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token comment">// 如果有对象</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>intersects<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 修改颜色</span>
    intersects<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>object<span class="token punctuation">.</span>material<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Color</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>点击方块会变换不同颜色</p> <iframe height="359" scrolling="no" title="鼠标点击交互" src="//codepen.io/kuminson/embed/NLeWaV/?height=359&theme-id=0&default-tab=result&embed-version=2" frameborder="no" allowtransparency="true" allowfullscreen="allowfullscreen" style="width: 100%;">See the Pen <a href="https://codepen.io/kuminson/pen/NLeWaV/">鼠标点击交互</a> by kuminson (<a href="https://codepen.io/kuminson">@kuminson</a>) on <a href="https://codepen.io">CodePen</a>.
</iframe> <h2 id="五、粒子"><a href="#五、粒子" class="header-anchor">#</a> 五、粒子</h2> <p>有两种绘制点的方法THREE.Sprite(material) 和 THREE.Points(geometry, material)，</p> <p>当数量比较多的时候，Points方法会更好的节省性能，因为大量点的坐标都可以放入一个geometry对象中进行管理，非常节省资源。</p> <p>粒子还有一个特性是他们没有方向，都是面向摄像机，外形是正方形，可以加入文理来改变样子。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 创建几何体对象</span>
<span class="token keyword">let</span> geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Geometry</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 创建材质</span>
<span class="token keyword">let</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PointsMaterial</span><span class="token punctuation">(</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token number">0x00ff00</span><span class="token punctuation">,</span>
  <span class="token literal-property property">size</span><span class="token operator">:</span> <span class="token number">0.1</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token comment">// 设置范围值</span>
<span class="token keyword">let</span> pointR <span class="token operator">=</span> <span class="token number">15</span>
<span class="token comment">// 循环生成点的位置</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 随机生成点位置</span>
  <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> pointR <span class="token operator">-</span> pointR <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> pointR <span class="token operator">-</span> pointR <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> pointR <span class="token operator">-</span> pointR <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span>
  <span class="token comment">// 把位置加入到几何体中</span>
  geometry<span class="token punctuation">.</span>vertices<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 生成点</span>
<span class="token keyword">let</span> box <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Points</span><span class="token punctuation">(</span> geometry<span class="token punctuation">,</span> material <span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><iframe height="370" scrolling="no" title="粒子" src="//codepen.io/kuminson/embed/rZoOeO/?height=370&theme-id=0&default-tab=result&embed-version=2" frameborder="no" allowtransparency="true" allowfullscreen="allowfullscreen" style="width: 100%;">See the Pen <a href="https://codepen.io/kuminson/pen/rZoOeO/">粒子</a> by kuminson (<a href="https://codepen.io/kuminson">@kuminson</a>) on <a href="https://codepen.io">CodePen</a>.
</iframe> <h2 id="六、阴影"><a href="#六、阴影" class="header-anchor">#</a> 六、阴影</h2> <p>有时候需要阴影效果，增加灯光和一些材质配置就能达到效果</p> <div class="warning custom-block"><p class="custom-block-title">注意</p> <p>阴影非常消耗资源，要谨慎调整配置</p></div> <p>渲染器要开启阴影渲染</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>renderer<span class="token punctuation">.</span>shadowMap<span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token boolean">true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>效果更好的阴影算法</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>renderer<span class="token punctuation">.</span>shadowMap<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>PCFSoftShadowMap
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>需要灯光</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 增加灯光</span>
<span class="token keyword">let</span> spotLight <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SpotLight</span><span class="token punctuation">(</span> <span class="token number">0xffffff</span> <span class="token punctuation">)</span>
<span class="token comment">// 调整位置</span>
spotLight<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span> <span class="token punctuation">)</span>
<span class="token comment">// 调整朝向</span>
spotLight<span class="token punctuation">.</span><span class="token function">lookAt</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// 允许渲染阴影</span>
spotLight<span class="token punctuation">.</span>castShadow <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token comment">// 修改阴影质量</span>
spotLight<span class="token punctuation">.</span>shadow<span class="token punctuation">.</span>mapSize<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">2048</span>
spotLight<span class="token punctuation">.</span>shadow<span class="token punctuation">.</span>mapSize<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">2048</span>
<span class="token comment">// 加入场景</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>spotLight<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>设置可以产生阴影的mesh</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>box<span class="token punctuation">.</span>castShadow <span class="token operator">=</span> <span class="token boolean">true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>设置可以接受阴影的mesh，平面都可以接受</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>plane<span class="token punctuation">.</span>receiveShadow <span class="token operator">=</span> <span class="token boolean">true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><iframe height="365" scrolling="no" title="阴影" src="//codepen.io/kuminson/embed/OoryaG/?height=365&theme-id=0&default-tab=result&embed-version=2" frameborder="no" allowtransparency="true" allowfullscreen="allowfullscreen" style="width: 100%;">See the Pen <a href="https://codepen.io/kuminson/pen/OoryaG/">阴影</a> by kuminson (<a href="https://codepen.io/kuminson">@kuminson</a>) on <a href="https://codepen.io">CodePen</a>.
</iframe> <h2 id="七、插件"><a href="#七、插件" class="header-anchor">#</a> 七、插件</h2> <p>官方推荐了三个插件，分别是用来调整摄像机的orbitControls、性能检测器stats.js和可视化调参dat.GUI</p> <h3 id="_1-orbitcontrols"><a href="#_1-orbitcontrols" class="header-anchor">#</a> 1.orbitControls</h3> <p>安装</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">npm</span> <span class="token function">install</span> three-orbit-controls
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 引入</span>
<span class="token keyword">import</span> orbit <span class="token keyword">from</span> <span class="token string">'three-orbit-controls'</span>
<span class="token comment">// 摄像机控制器绑定到three上</span>
<span class="token keyword">let</span> OrbitControls <span class="token operator">=</span> <span class="token function">orbit</span><span class="token punctuation">(</span><span class="token constant">THREE</span><span class="token punctuation">)</span>
<span class="token comment">// 实例化摄像机控制器</span>
orbitControls <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OrbitControls</span><span class="token punctuation">(</span>camera<span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">anima</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 改变摄像机朝向</span>
  orbitControls<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// 渲染一帧</span>
  renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>scene<span class="token punctuation">,</span> camera<span class="token punctuation">)</span>
  <span class="token comment">// 渲染</span>
  <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>anima<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">anima</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="_2-stats-js"><a href="#_2-stats-js" class="header-anchor">#</a> 2.stats.js</h3> <p>安装</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">npm</span> <span class="token function">install</span> stats.js
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> Stats <span class="token keyword">from</span> <span class="token string">'stats'</span>
<span class="token keyword">let</span> stats <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Stats</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//设置统计模式</span>
stats<span class="token punctuation">.</span><span class="token function">setMode</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// 0: fps, 1: ms, 2: mb, 3+: custom</span>
stats<span class="token punctuation">.</span>domElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token string">'absolute'</span>
stats<span class="token punctuation">.</span>domElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token string">'0px'</span>
stats<span class="token punctuation">.</span>domElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token string">'0px'</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span> stats<span class="token punctuation">.</span>domElement <span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">anima</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//通知stats画面已被重新渲染了</span>
    stats<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// 渲染一帧</span>
  renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>scene<span class="token punctuation">,</span> camera<span class="token punctuation">)</span>
  <span class="token comment">// 渲染</span>
  <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>anima<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">anima</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><iframe height="357" scrolling="no" title="stats.js" src="//codepen.io/kuminson/embed/wERWmZ/?height=357&theme-id=0&default-tab=result&embed-version=2" frameborder="no" allowtransparency="true" allowfullscreen="allowfullscreen" style="width: 100%;">See the Pen <a href="https://codepen.io/kuminson/pen/wERWmZ/">stats.js</a> by kuminson (<a href="https://codepen.io/kuminson">@kuminson</a>) on <a href="https://codepen.io">CodePen</a>.
</iframe> <h3 id="_3-dat-gui"><a href="#_3-dat-gui" class="header-anchor">#</a> 3.dat.GUI</h3> <p>安装</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">npm</span> <span class="token function">install</span> dat.gui
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> dat <span class="token keyword">from</span> <span class="token string">'dat.gui'</span>
<span class="token comment">// 创建参数对象</span>
<span class="token keyword">let</span> fizzyText <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">speed</span><span class="token operator">:</span> <span class="token number">0.01</span><span class="token punctuation">,</span>
  <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token number">0.2</span>
<span class="token punctuation">}</span>
<span class="token comment">// 实例化可视化调参面板</span>
<span class="token keyword">let</span> gui <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">dat<span class="token punctuation">.</span>GUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 增加参数</span>
gui<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>fizzyText<span class="token punctuation">,</span> <span class="token string">'speed'</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">)</span>
gui<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>fizzyText<span class="token punctuation">,</span> <span class="token string">'color'</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">anima</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 应用参数</span>
  <span class="token comment">// box绕y轴旋转</span>
  box<span class="token punctuation">.</span>rotation<span class="token punctuation">.</span>y <span class="token operator">+=</span> fizzyText<span class="token punctuation">.</span>speed
  box<span class="token punctuation">.</span>material<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Color</span><span class="token punctuation">(</span>fizzyText<span class="token punctuation">.</span>color <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span> fizzyText<span class="token punctuation">.</span>color<span class="token punctuation">,</span> fizzyText<span class="token punctuation">.</span>color <span class="token operator">*</span> <span class="token number">0.4</span><span class="token punctuation">)</span>
  <span class="token comment">// 渲染一帧</span>
  renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>scene<span class="token punctuation">,</span> camera<span class="token punctuation">)</span>
  <span class="token comment">// 渲染</span>
  <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>anima<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">anima</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><iframe height="362" scrolling="no" title="dat.GUI" src="//codepen.io/kuminson/embed/eLbgVZ/?height=362&theme-id=0&default-tab=result&embed-version=2" frameborder="no" allowtransparency="true" allowfullscreen="allowfullscreen" style="width: 100%;">See the Pen <a href="https://codepen.io/kuminson/pen/eLbgVZ/">dat.GUI</a> by kuminson (<a href="https://codepen.io/kuminson">@kuminson</a>) on <a href="https://codepen.io">CodePen</a>.
</iframe></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/document-ThreeJs/advanced/" class="prev router-link-active">
          疑问
        </a></span> <span class="next"><a href="/document-ThreeJs/advanced/keng.html">
          踩坑
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/document-ThreeJs/assets/js/app.a4ba395c.js" defer></script><script src="/document-ThreeJs/assets/js/6.38b6a451.js" defer></script>
  </body>
</html>
